# K8s 管理平台开发任务清单

## 第0.5周：原型图设计阶段

### UI/UX 设计任务
- [✓] 集群管理页面原型设计
  - [✓] 集群列表页面原型
  - [✓] 集群详情页面原型
  - [✓] 集群导入向导页面原型
- [✓] 节点管理页面原型设计
  - [✓] 节点列表页面原型
  - [✓] 节点详情页面原型
  - [✓] 节点操作面板原型
- [✓] 工作负载管理页面原型设计
  - [✓] 工作负载列表页面原型
  - [✓] 工作负载详情页面原型
  - [✓] YAML编辑器界面原型
- [✓] Pod管理页面原型设计
  - [✓] Pod列表页面原型
  - [✓] Pod详情页面原型
  - [✓] Pod日志查看界面原型
  - [✓] Pod终端界面原型
- [✓] 全局功能页面原型设计
  - [✓] 全局搜索页面原型
  - [✓] 审计页面原型
- [✓] 整体设计规范
  - [✓] 整体布局与导航结构设计
  - [✓] 交互流程设计
  - [✓] 状态设计（加载、错误、空状态等）
  - [✓] 完整原型图文档输出

**交付物：** 完整的原型图文档，前端开发可直接参考

---

## 第1周：项目基建阶段

### 前端基建任务
- [✓] 项目初始化
  - [✓] 创建 Vite + React + TypeScript 项目
  - [✓] 配置 Ant Design 组件库
  - [✓] 项目文档编写（README.md）
  - [✓] 配置 ESLint 和 Prettier
- [✓] 基础架构搭建
  - [✓] 基于原型图搭建路由结构
  - [✓] 搭建基础布局组件
  - [✓] 创建所有页面组件基础结构
  - [ ] 实现鉴权守卫机制
  - [ ] 配置状态管理（Redux/Zustand）
- [✓] 开发环境配置
  - [✓] 配置开发服务器
  - [ ] 配置代理设置
  - [ ] 配置环境变量

### 后端基建任务
- [✓] 项目初始化
  - [✓] 创建 Go Gin 项目脚手架
  - [✓] 配置项目结构和包管理
- [✓] 基础中间件开发
  - [✓] 实现配置管理（Viper）
  - [✓] 实现日志中间件（klog）
  - [ ] 实现错误码统一处理
  - [✓] 实现鉴权中间件
  - [ ] 实现审计中间件
  - [ ] 实现限流中间件
- [✓] 数据库设置
  - [✓] MySQL 连接配置
  - [✓] 数据库迁移脚本
  - [✓] RBAC 相关表结构
- [✓] 集群注册模块
  - [✓] Cluster Registry 基础结构
  - [✓] 集群连接管理

**交付物：** 登录可用、集群导入 API 雏形 ✅ 已完成

---

## 第2周：集群与监控阶段

### 前端开发任务
- [✓] 集群管理界面
  - [✓] 按原型图实现集群列表页面
  - [✓] 按原型图实现集群详情页面
  - [✓] 按原型图实现集群导入向导界面
  - [✓] 集群状态展示组件
- [✓] 监控图表组件
  - [✓] 集成 AntV G2Plot
  - [✓] 实现 CPU/内存监控图表
  - [✓] 实现网络/磁盘监控图表
  - [✓] 时间范围选择组件

### 后端开发任务
- [✓] 集群管理 API
  - [✓] 集群导入接口实现
  - [✓] 集群列表接口实现
  - [✓] 集群详情接口实现
- [✓] 集群连接与监控
  - [✓] 集群连接探测功能
  - [✓] 权限自检功能
  - [✓] Prometheus 监控接入
  - [✓] metrics-server 降级方案
- [✓] Web 终端功能
  - [✓] WebSocket 终端连接 ✅ 2024-08-20
  - [✓] kubectl 命令代理 ✅ 2024-08-20
  - [✓] 终端会话审计 ✅ 2024-08-20
  - [✓] 命名空间切换功能 ✅ 2024-08-20

**交付物：** 导入/浏览/终端可用，概览图表展示 ✅ 已完成

---

## 第3周：节点管理阶段 【当前阶段】

### 前端开发任务
- [✓] 节点管理界面
  - [✓] 按原型图实现节点列表页面 ✅ 2024-08-21
  - [✓] 按原型图实现节点详情页面 ✅ 2024-08-22
  - [✓] 按原型图实现节点监控界面 ✅ 2024-08-22
- [✓] 节点操作组件
  - [✓] Cordon/Uncordon 操作界面 ✅ 2024-08-21
  - [✓] Drain 操作界面（带选项） ✅ 2024-08-21
  - [✓] 节点终端组件 ✅ 2024-08-22

### 后端开发任务
- [✓] 节点管理 API
  - [✓] 节点列表接口实现 ✅ 2024-08-21
  - [✓] 节点详情接口实现 ✅ 2024-08-21
  - [✓] 节点监控数据接口 ✅ 2024-08-21
- [✓] 节点操作功能
  - [✓] Cordon 功能实现 ✅ 2024-08-21
  - [✓] Uncordon 功能实现 ✅ 2024-08-21
  - [✓] Drain 功能实现（带选项支持） ✅ 2024-08-21
- [✓] 节点终端功能
  - [✓] kubectl debug 实现 ✅ 2024-08-22
  - [✓] SSH终端支持 ✅ 2024-08-22
  - [ ] nsenter 集成
  - [ ] 资源清理机制

**交付物：** 节点运维闭环 ✅ 2024-08-22

---

## 第4周：工作负载与 Pod 阶段 【当前阶段】

### 开发计划（天1-2：工作负载基础功能）
- [✓] 后端工作负载API开发 ✅ 2024-08-22
  - [✓] 工作负载列表接口（支持Deployments/StatefulSets/DaemonSets/Jobs/CronJobs）
  - [✓] 工作负载详情接口
  - [✓] 工作负载类型服务实现
- [✓] 前端工作负载界面 ✅ 2024-08-22
  - [✓] 工作负载列表页面实现
  - [✓] 工作负载详情页面实现
  - [✓] 工作负载服务层实现
  - [✓] 工作负载操作功能（扩缩容、删除）

### 开发计划（天3-4：Pod基础功能）
- [ ] 后端Pod API开发
  - [ ] Pod列表接口实现
  - [ ] Pod详情接口实现
  - [ ] Pod筛选和分页功能
- [ ] 前端Pod界面
  - [ ] Pod列表页面实现
  - [ ] Pod详情页面基础结构
  - [ ] Pod服务层实现

### 开发计划（天5-6：YAML编辑器）
- [ ] YAML编辑器集成
  - [ ] 集成 Monaco Editor
  - [ ] YAML 语法高亮
  - [ ] YAML 校验功能
  - [ ] Diff 对比功能
- [ ] 后端YAML操作
  - [ ] YAML 应用接口（server-side apply）
  - [ ] dryRun 支持
  - [ ] YAML 校验功能

### 开发计划（天7-8：Pod日志和终端）
- [ ] Pod日志功能
  - [ ] Pod 日志接口（follow/tail 支持）
  - [ ] Pod 日志查看界面
  - [ ] 实时日志流处理
- [ ] Pod终端功能
  - [ ] Pod 终端 WebSocket 接口
  - [ ] Pod 终端界面
  - [ ] 多容器支持

### 开发计划（天9-10：工作负载操作完善）
- [✓] 工作负载操作功能 ✅ 2024-08-22
  - [✓] 工作负载扩缩容接口
  - [✓] 工作负载删除接口
  - [✓] YAML应用接口（含dryRun支持）
- [ ] 前端操作界面完善
  - [ ] 工作负载详情页面完善
  - [ ] 工作负载操作组件
  - [ ] 批量操作支持

**交付物：** 应用层日常运维闭环

---

## 第5-6周：全局搜索与完善阶段

### 前端开发任务
- [ ] 全局搜索界面
  - [ ] 按原型图实现全局搜索页面
  - [ ] 搜索结果展示组件
  - [ ] 搜索过滤器组件
- [ ] 审计功能界面
  - [ ] 按原型图实现审计页面
  - [ ] 终端会话列表
  - [ ] 会话详情与回放
- [ ] 用户体验优化
  - [ ] 错误边界处理
  - [ ] 加载状态优化
  - [ ] 空状态页面

### 后端开发任务
- [ ] 全局搜索功能
  - [ ] 搜索 API 实现
  - [ ] K8s API 聚合查询
  - [ ] 内存缓存机制（TTL）
  - [ ] 搜索结果排序与分页
- [ ] 审计功能完善
  - [ ] 终端会话查询接口
  - [ ] 会话详情接口
  - [ ] 命令记录查询接口
  - [ ] 审计数据导出功能
- [ ] 系统完善
  - [ ] 权限细化实现
  - [ ] 异常边界覆盖
  - [ ] 性能优化
  - [ ] 安全加固

**交付物：** 一期对外可验收版本

---

## 第7周：UI优化与用户体验完善阶段

### 前端优化任务
- [ ] 界面细节优化
  - [ ] 基于原型图进行界面细节调整
  - [ ] 组件样式优化
  - [ ] 交互动效优化
- [ ] 响应式适配
  - [ ] 移动端适配
  - [ ] 平板端适配
  - [ ] 不同分辨率适配
- [ ] 用户体验优化
  - [ ] 操作反馈优化
  - [ ] 错误提示优化
  - [ ] 快捷键支持
- [ ] 性能优化
  - [ ] 组件懒加载
  - [ ] 图片优化
  - [ ] 打包优化

### 后端优化任务
- [ ] 性能优化
  - [ ] API 响应时间优化
  - [ ] 数据库查询优化
  - [ ] 缓存策略优化
- [ ] 稳定性优化
  - [ ] 错误处理完善
  - [ ] 日志记录完善
  - [ ] 监控告警配置
- [ ] 安全优化
  - [ ] 安全漏洞扫描
  - [ ] 权限控制加强
  - [ ] 数据加密完善

### 第8周： Todo 记录
kubectl 终端封装为容器， 要不然依赖环境有 kubectl 命令

### 测试与部署
- [ ] 功能测试
  - [ ] 单元测试补充
  - [ ] 集成测试
  - [ ] 端到端测试
- [ ] 部署准备
  - [ ] 部署文档编写
  - [ ] 环境配置
  - [ ] 上线检查清单

**交付物：** 用户体验优化版本

---

## 验收标准检查清单

### 功能验收
- [ ] 集群导入成功率 ≥ 95%
- [ ] 失败原因可视化展示
- [ ] 集群/节点/Pod 指标展示正常
- [ ] Web 终端可用率 ≥ 99%（断线可重连）
- [ ] 节点操作（cordon/drain）可靠，有回滚/提示
- [ ] 工作负载扩缩容/YAML 变更成功率 ≥ 95%
- [ ] 变更可追溯
- [ ] Pod 日志 follow 稳定
- [ ] 搜索平均响应 ≤ 1.5s（1w+对象）
- [ ] 每次终端会话均有 session 与输入流记录
- [ ] 审计数据可检索导出

### 技术验收
- [ ] 代码质量检查通过
- [ ] 安全扫描通过
- [ ] 性能测试通过
- [ ] 兼容性测试通过
- [ ] 文档完整性检查通过

---

## 项目里程碑

- [✓] **里程碑1（第0.5周末）：** 原型图设计完成 ✅ 2024-08-15
- [✓] **里程碑2（第1周末）：** 项目基建完成，登录可用 ✅ 2024-08-18
- [✓] **里程碑3（第2周末）：** 集群管理功能完成 ✅ 2024-08-20
- [✓] **里程碑4（第3周末）：** 节点管理功能完成 ✅ 2024-08-22
- [ ] **里程碑5（第4周末）：** 工作负载与Pod管理功能完成
- [ ] **里程碑6（第6周末）：** 全局搜索与审计功能完成
- [ ] **里程碑7（第7周末）：** 项目完整交付

---

## 风险控制检查清单

- [ ] K8s 版本兼容性测试
- [ ] 权限差异处理验证
- [ ] 终端命令审计功能验证
- [ ] Prometheus 监控接入测试
- [ ] 降级方案验证
- [ ] 性能压力测试
- [ ] 安全漏洞扫描

---

**使用说明：**
1. 每完成一项任务，在对应的 `[ ]` 中打 `✓` 标记为 `[✓]`
2. 可以在任务后添加完成时间和负责人
3. 遇到问题可以在任务后添加备注
4. 定期更新进度，确保项目按计划推进